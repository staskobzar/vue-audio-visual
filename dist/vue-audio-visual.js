!function(t){var i={};function e(a){if(i[a])return i[a].exports;var n=i[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,e),n.l=!0,n.exports}e.m=t,e.c=i,e.d=function(t,i,a){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s="lVK7")}({lVK7:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a={props:{audioSrc:{type:String,default:null},audioElement:{type:HTMLAudioElement,default:null},audioControls:{type:Boolean,default:!0},corsAnonym:{type:Boolean,default:!1},audioClass:{type:String,default:null},canvWidth:{type:Number,default:300},canvHeight:{type:Number,default:80},canvClass:{type:String,default:null},canvTop:{type:Boolean,default:!1},canvFillColor:{type:[String,Array],default:null}},render:function(t){return t("div")},mounted:function(){this.createHTMLElements(),this.setAnalyser(),this.mainLoop()},methods:{createHTMLElements:function(){var t=this.audioElement||document.createElement("audio"),i=document.createElement("div"),e=document.createElement("canvas"),a=document.createElement("div");this.audioElement||(t.setAttribute("src",this.audioSrc),this.audioControls&&t.setAttribute("controls",!0),this.audioClass&&t.setAttribute("class",this.audioClass),this.corsAnonym&&(t.crossOrigin="anonymous"),i.appendChild(t),this.$el.appendChild(i)),this.canvClass&&e.setAttribute("class",this.canvClass),this.canvWidth&&e.setAttribute("width",this.canvWidth),this.canvHeight&&e.setAttribute("height",this.canvHeight),a.appendChild(e),this.canvTop?this.$el.insertBefore(a,i):this.$el.appendChild(a),this.ctx=e.getContext("2d"),this.audio=t},setAnalyser:function(){var t=new AudioContext,i=t.createMediaElementSource(this.audio);this.analyser=t.createAnalyser(),i.connect(this.analyser),this.analyser.fftSize=this.fftSize,this.analyser.connect(t.destination)},fillGradient:function(t){var i=this.canvWidth,e=this.canvHeight,a=this.ctx.createLinearGradient(i/2,0,i/2,e),n=0;return t.forEach(function(i){a.addColorStop(n,i),n+=1/t.length}),a}}},n={name:"av-bars",mixins:[a],props:{barWidth:{type:Number,default:5},barSpace:{type:Number,default:1},barColor:{type:[String,Array],default:"#0A0AFF"},capsHeight:{type:Number,default:0},capsDropSpeed:{type:Number,default:.9},capsColor:{type:String,default:"#A0A0FF"},brickHeight:{type:Number,default:0},brickSpace:{type:Number,default:1},symmetric:{type:Boolean,default:!1},fftSize:{type:Number,default:1024}},data:function(){return{audio:null,analyser:null,ctx:null,caps:Array.apply(null,Array(this.fftSize/2)).map(function(){return 0})}},methods:{mainLoop:function(){var t=this,i=this.analyser.frequencyBinCount,e=new Uint8Array(i),a=this.barWidth>=this.canvWidth?this.canvWidth:this.barWidth,n=Math.round((a+this.barSpace)/i*this.canvWidth),r=Array.isArray(this.barColor)?this.fillGradient(this.barColor):this.barColor,s=0;this.analyser.getByteFrequencyData(e),this._fillCanvasBG(),e.forEach(function(i,o){if(!(o%n)){var h=Math.round(e.slice(o,o+n).reduce(function(t,i){return i+t},0)/n),l=h/255*t.canvHeight;t.capsHeight&&t._drawCap(o,a,s,h),t.ctx.fillStyle=r,t._drawBar(a,l,s),s+=a+t.barSpace}}),requestAnimationFrame(this.mainLoop)},_fillCanvasBG:function(){var t=this.canvWidth,i=this.canvHeight;this.ctx.clearRect(0,0,t,i),this.canvFillColor&&(this.ctx.fillStyle=Array.isArray(this.canvFillColor)?this.fillGradient(this.canvFillColor):this.canvFillColor,this.ctx.fillRect(0,0,t,i))},_drawBar:function(t,i,e){this.brickHeight?this._drawBrickBar(t,i,e):this.ctx.fillRect(e,this.canvHeight-i-this._symAlign(i),t,i)},_drawBrickBar:function(t,i,e){for(var a=0;a<i;a+=this.brickHeight+this.brickSpace)this.ctx.fillRect(e,this.canvHeight-i+a-this._symAlign(i),t,this.brickHeight)},_drawCap:function(t,i,e,a){var n=this.caps[t]<=a?a:this.caps[t]-this.capsDropSpeed,r=n/255*this.canvHeight,s=this.canvHeight-r-this.capsHeight-this._symAlign(r);this.ctx.fillStyle=this.capsColor,this.ctx.fillRect(e,s,i,this.capsHeight),this.symmetric&&this.ctx.fillRect(e,this.canvHeight-s-this.capsHeight,i,this.capsHeight),this.caps[t]=n},_symAlign:function(t){return this.symmetric?(this.canvHeight-t)/2:0}}},r={name:"av-line",mixins:[a],props:{lineWidth:{type:Number,default:2},lineColor:{type:[String,Array],default:"#9F9"},fftSize:{type:Number,default:128}},data:function(){return{audio:null,analyser:null,ctx:null}},methods:{mainLoop:function(){var t=this.analyser.frequencyBinCount,i=this.canvWidth/2/t,e=new Uint8Array(t),a=0;this._setCanvas(),this.analyser.getByteFrequencyData(e),this.ctx.lineWidth=this.lineWidth,this.ctx.strokeStyle=Array.isArray(this.lineColor)?this.fillGradient(this.lineColor):this.lineColor,this.ctx.beginPath(),e.reverse(),this.ctx.moveTo(a,this.canvHeight/2),a=this._drawLine(e,a,i),e.reverse(),a=this._drawLine(e,a,i),this.ctx.lineTo(+this.canvWidth,this.canvHeight/2),this.ctx.stroke(),requestAnimationFrame(this.mainLoop)},_setCanvas:function(){var t=this.canvWidth,i=this.canvHeight,e=this.canvFillColor,a=this.ctx.createLinearGradient(t/2,0,t/2,i),n=0;this.ctx.clearRect(0,0,t,i),e&&(Array.isArray(e)?(e.forEach(function(t){a.addColorStop(n,t),n+=1/e.length}),this.ctx.fillStyle=a):this.ctx.fillStyle=e,this.ctx.fillRect(0,0,t,i))},_drawLine:function(t,i,e){var a=this,n=+this.canvHeight,r=0;return t.forEach(function(t,s){r=n*(255-t)/510,s%2&&(r=n-r),a.ctx.lineTo(i,r),i+=e}),i}}},s={name:"av-circle",mixins:[a],props:{fftSize:{type:Number,default:1024},canvWidth:{type:Number,default:100},canvHeight:{type:Number,default:100},radius:{type:Number,default:0},lineWidth:{type:Number,default:1},lineSpace:{type:Number,default:1},outlineColor:{type:String,default:"#0000FF"},outlineWidth:{type:Number,default:.3},barWidth:{type:Number,default:1},barLength:{type:Number,default:0},barColor:{type:[String,Array],default:function(){return["#FFFFFF","#0000FF"]}},progress:{type:Boolean,default:!0},progressWidth:{type:Number,default:1},progressColor:{type:String,default:"#0000FF"},progressClockwise:{type:Boolean,default:!1},outlineMeterSpace:{type:Number,default:3},playtime:{type:Boolean,default:!1},playtimeFont:{type:String,default:"14px Monaco"},playtimeColor:{type:String,default:"#00f"},rotateGraph:{type:Boolean,default:!1},rotateSpeed:{type:Number,default:.001}},data:function(){return{rotate:1.5,audio:null,analyser:null,ctx:null}},methods:{mainLoop:function(){var t=this,i=this.canvWidth/2,e=this.canvHeight/2,a=this.radius?this.radius:Math.round(this.canvWidth/2*.7),n=this.lineWidth,r=this.lineSpace,s=Math.ceil(n+r),o=this.analyser.frequencyBinCount,h=new Uint8Array(o),l=(n+r)/h.length*(2*Math.PI),c=this.barLength>0?this.barLength:this.canvWidth/2-a,u=Math.PI*this._rotate();this._setCanvas(),this.analyser.getByteFrequencyData(h),this.outlineWidth>0&&this._drawOutline(a,i,e),this.progress&&this._drawProgress(a,i,e),this.playtime&&this._drawPlaytime(i,e),this.ctx.lineWidth=this.barWidth,this.ctx.strokeStyle=this._setBarColor(i,e),h.forEach(function(n,r){if(u+=l,!(r%s)){var o=Math.round(h.slice(r,r+s).reduce(function(t,i){return i+t},0)/s),d=a+o/255*c;t.ctx.beginPath(),t.ctx.moveTo(a*Math.cos(u)+i,a*Math.sin(u)+e),t.ctx.lineTo(d*Math.cos(u)+i,d*Math.sin(u)+e),t.ctx.stroke()}}),requestAnimationFrame(this.mainLoop)},_setCanvas:function(){this.ctx.clearRect(0,0,this.canvWidth,this.canvHeight),this.canvFillColor&&(this.ctx.fillStyle=Array.isArray(this.canvFillColor)?this.fillGradient(this.canvFillColor):this.canvFillColor,this.ctx.fillRect(0,0,this.canvWidth,this.canvHeight))},_drawProgress:function(t,i,e){var a=this.audio.currentTime/this.audio.duration*2*Math.PI,n=1.5*Math.PI+a;a&&(this.ctx.lineWidth=this.progressWidth,this.ctx.strokeStyle=this.progressColor,this.ctx.beginPath(),this.ctx.arc(i,e,t-this.outlineWidth-this.outlineMeterSpace,1.5*Math.PI,n,this.progressClockwise),this.ctx.stroke())},_drawOutline:function(t,i,e){this.ctx.beginPath(),this.ctx.strokeStyle=this.outlineColor,this.ctx.lineWidth=this.outlineWidth,this.ctx.arc(i,e,t,0,2*Math.PI),this.ctx.stroke()},_drawPlaytime:function(t,i){var e=Math.floor(this.audio.currentTime/60),a=Math.floor(this.audio.currentTime)%60,n=e+":"+(a<10?"0"+a:""+a),r=Math.ceil(this.ctx.measureText(n).width);this.ctx.font=this.playtimeFont,this.ctx.fillStyle=this.playtimeColor,this.ctx.fillText(n,t-Math.round(r/2),i+.25*parseInt(this.playtimeFont))},_rotate:function(){return this.rotateGraph?this.rotate=3.5===this.rotate?1.5:this.rotate+this.rotateSpeed:this.rotate=1.5,this.rotate},_setBarColor:function(t,i){var e=this;if(!Array.isArray(this.barColor))return this.barColor;var a=this.ctx.createRadialGradient(t,i,this.canvWidth/2,t,i,0),n=0;return this.barColor.forEach(function(t){a.addColorStop(n,t),n+=1/e.barColor.length}),a}}},o={install:function(t){window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,t.component(n.name,n),t.component(r.name,r),t.component(s.name,s)}};i.default=o}});
//# sourceMappingURL=vue-audio-visual.js.map